<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Examples</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
<!-- <script type="text/javascript" src="js/bind.js"></script>
<script type="text/javascript" src="js/AOP.js"></script>
<script type="text/javascript" src="js/currying.js"></script>
<script type="text/javascript" src="js/callee.js"></script>
<script type="text/javascript" src="js/throttle.js"></script> -->
<script type="text/javascript" src="js/caller.js"></script>
<!-- <script type="text/javascript" src="js/globalFun.js"></script> -->

<!-- <script type="text/javascript" src="js/imgload.js"></script> -->
<!-- <script type="text/javascript" src="js/Array/forEach.js"></script> -->
<!-- <script type="text/javascript" src="js/Array/map.js"></script> -->
<!-- <script type="text/javascript" src="js/Array/filter.js"></script> -->
<!-- <script type="text/javascript" src="js/Array/some.js"></script> -->
<!-- <script type="text/javascript" src="js/Array/reduce.js"></script> -->
</head>
<body>
   <p id="result"></p>

   <script type="text/javascript">
   	
   	// 统计用户 访问网站步骤记录
var tjSecond = 0;
var tjRandom = 0;
window.setInterval(function () {
    tjSecond ++;
}, 1000);
// 随机数
tjRandom = (new Date()).valueOf();
// 用户第一次访问页面记录部分数据
window.onload = function () {
    var tjArr = localStorage.getItem("jsArr") ? localStorage.getItem("jsArr") : '[]';
    var dataArr = {
        'tjRd' : tjRandom,
        'url' : location.href,
        'refer' : getReferrer()
    };
    tjArr = eval('(' + tjArr + ')');
    tjArr.push(dataArr);
    var tjArr1= JSON.stringify(tjArr);
    localStorage.setItem("jsArr", tjArr1);
};
// 用户继续访问根据上面提供的key值补充数据
window.onbeforeunload = function() {
    var tjArrRd = eval('(' + localStorage.getItem("jsArr") + ')');
    var tjI = tjArrRd.length - 1;
    if(tjArrRd[tjI].tjRd == tjRandom){
        tjArrRd[tjI].time = tjSecond;
        tjArrRd[tjI].timeIn = Date.parse(new Date()) - (tjSecond * 1000);
        tjArrRd[tjI].timeOut = Date.parse(new Date());
        var tjArr1= JSON.stringify(tjArrRd);
        localStorage.setItem("jsArr", tjArr1);
    }
};

function getReferrer() {
    var referrer = '';
    try {
        referrer = window.top.document.referrer;
    } catch(e) {
        if(window.parent) {
            try {
                referrer = window.parent.document.referrer;
            } catch(e2) {
                referrer = '';
            }
        }
    }
    if(referrer === '') {
        referrer = document.referrer;
    }
    return referrer;
}

   </script>
</body>
</html>